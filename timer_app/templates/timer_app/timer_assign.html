{% extends "timer_app/base.html" %}

{% block title %}Assign Timer - Timer Tracker{% endblock %}

{% block breadcrumb %}
<div class="breadcrumb">
    <a href="{% url 'home' %}">Home</a>
    <span>›</span>
    <a href="{% url 'customer_list' %}">Customers</a>
    <span>›</span>
    <a href="{% url 'customer_detail' project.customer.pk %}">{{ project.customer.name }}</a>
    <span>›</span>
    <a href="{% url 'project_detail' project.pk %}">{{ project.name }}</a>
    <span>›</span>
    <span>Assign Timer</span>
</div>
{% endblock %}

{% block content %}
<div class="card" style="max-width: 600px;">
    <div class="card-header">Assign Timer to {{ project.name }}</div>
    
    {% if timers %}
    <form method="post">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="timer" class="form-label">Select Timer:</label>
            <select name="timer" id="timer" class="form-input" required>
                <option value="">-- Choose a timer --</option>
                {% for timer in timers %}
                    {% if timer.pk in assigned_timer_ids %}
                        <option value="{{ timer.pk }}" disabled>{{ timer.task_name }} - £{{ timer.price_per_hour }}/hr (Already assigned)</option>
                    {% else %}
                        <option value="{{ timer.pk }}">{{ timer.task_name }} - £{{ timer.price_per_hour }}/hr</option>
                    {% endif %}
                {% endfor %}
            </select>
            <p style="margin-top: 0.5rem; font-size: 0.875rem; color: #666;">
                Don't see the timer you need? <a href="{% url 'timer_create' %}">Create a new timer</a>
            </p>
        </div>

        <div class="actions">
            <button type="submit" class="btn">Assign Timer</button>
            <a href="{% url 'project_detail' project.pk %}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
    {% else %}
    <p>You don't have any timers yet. <a href="{% url 'timer_create' %}">Create your first timer</a> to get started!</p>
    <div class="actions">
        <a href="{% url 'project_detail' project.pk %}" class="btn btn-secondary">Back to Project</a>
    </div>
    {% endif %}
</div>
{% endblock %}

